[CmdletBinding()]param (    [Parameter(Mandatory = $True)][string]$vip,    [Parameter(Mandatory = $True)][string]$username,    [Parameter(Mandatory = $True)][string]$password)# Source the cohesity-api helper code. ./cohesity-api.ps1# Authenticateapiauth -vip $vip -username $username -password $password -quiet# 1. Check for a successful recovery of Guest-VM-1 to original location, original name$recoveries = api get -v2 data-protect/recoveries$goodRecovery = $null$recoveryEndTime = $nullforeach ($recovery in $recoveries.recoveries) {    if ($recovery.status -eq "Succeeded" -and $recovery.recoveryAction -eq "RecoverVMs" -and $recovery.hypervParams.objects) {        foreach ($obj in $recovery.hypervParams.objects) {            if ($obj.objectInfo.name -eq "Guest-VM-1") {                $prefixPresent = $false                $altLocationPresent = $false                if ($recovery.hypervParams.recoverVmParams.hypervTargetParams.renameRecoveredVmsParams) {                    $prefixPresent = $true                }                if ($recovery.hypervParams.recoverVmParams.hypervTargetParams.recoveryTargetConfig.recoverToNewSource) {                    $altLocationPresent = $true                }                if (-not $prefixPresent -and -not $altLocationPresent) {                    $goodRecovery = $recovery                    $recoveryEndTime = $recovery.endTimeUsecs                    break                }            }        }    }    if ($goodRecovery) { break }}if (-not $goodRecovery) {    Write-Host "You must perform a recovery of Guest-VM-1 to the original location with the original name."    Write-Host "Incorrect"    exit}# 2. Check Guest-VM-1 is back in the protection group and no missing entities$pgs = api get -v2 data-protect/protection-groups$pg = $pgs.protectionGroups | Where-Object { $_.name -eq "VirtualProtection" }$objectNames = @()if ($pg -and $pg.hypervParams.objects) {    $objectNames = $pg.hypervParams.objects | ForEach-Object { $_.name }}if ($pg) {    if ($pg.missingEntities -and $pg.missingEntities.Count -gt 0) {        Write-Host "Refresh the source and add Guest-VM-1 back into the protection group."        Write-Host "Incorrect"        exit    }    if (-not ($objectNames -contains "Guest-VM-1")) {        Write-Host "Ensure Guest-VM-1 is added back to the protection group after recovery."        Write-Host "Incorrect"        exit    }}# 3. Check the last run for Guest-VM-1 protection status using v2 APIif (-not $pg.lastRun -or -not $pg.lastRun.id) {    Write-Host "No last run found for 'VirtualProtection'."    Write-Host "Incorrect"    exit}$pgId = $pg.id$lastRunId = $pg.lastRun.id$lastRun = api get -v2 "data-protect/protection-groups/$pgId/runs/$lastRunId?includeObjectDetails=true"if (-not $lastRun -or -not $lastRun.objects) {    Write-Host "Could not retrieve last run details."    Write-Host "Incorrect"    exit}# Find Guest-VM-1 in the last run objects$guestVm1 = $lastRun.objects | Where-Object { $_.object.name -eq "Guest-VM-1" }if (-not $guestVm1) {    Write-Host "Guest-VM-1 was not protected in the last run."    Write-Host "Incorrect"    exit}$status = $guestVm1.localSnapshotInfo.snapshotInfo.statusif ($status -ne "kSuccess") {    Write-Host "Guest-VM-1 was not successfully protected in the last run."    Write-Host "Incorrect"    exit}# Optionally, check that only Guest-VM-1 was protected$protectedObjects = $lastRun.objects | Where-Object { $_.localSnapshotInfo.snapshotInfo.status -eq "kSuccess" }if ($protectedObjects.Count -ne 1 -or $protectedObjects[0].object.name -ne "Guest-VM-1") {    Write-Host "Only Guest-VM-1 should be protected in the last run."    Write-Host "Incorrect"    exit}Write-Host "Correct"exit
